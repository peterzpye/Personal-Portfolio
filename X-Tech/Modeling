Main Model codes. Including some feature engineering 
